{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Template that creates an S3 bucket",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::BUCKET",
            "Properties": {
                "BucketName": "testing_create_s3",
                "AccessControl": "PublicRead"
            },
            "DeletionPolicy": "Retain"
        },
        "BucketPolicy": {
            "Type": "AWS::S3::BucketPolicy",
            "Properties": {
                "PolicyDocument": {
                    "Id": "MyPolicy",
                    "Version": "2018-07-02",
                    "Statement": [
                        {
                            "Sid": "PublicReadForGetBucketObjects",
                            "Effect": "Allow",
                            "Principal": "*",
                            "Action": "s3.GetObject",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:s3:::"
                                    ],
                                    {
                                        "Ref": "S3Bucket"
                                    },
                                    "/*"
                                ]
                            }
                        }
                    ]
                },
                "Bucket": {
                    "Ref": "S3Bucket"
                }
            }
        }
    },
    "AWS::CloudFormation::Init": {
        "configSets": {
            "ascending": [
                "config1"
            ]
        },
        "config1": {
            "commands": {
                "test": {
                    "command": "echo \"$CFNTEST\" > test.txt",
                    "env": {
                        "CFNTEST": "Config1 test output :)"
                    },
                    "cwd": "~"
                }
            }
        }
    }
}